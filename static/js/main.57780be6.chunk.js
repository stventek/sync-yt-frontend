(this["webpackJsonpsync-yt-frontend"]=this["webpackJsonpsync-yt-frontend"]||[]).push([[0],{248:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(14),i=n.n(r),o=n(12),s=n(303),l=n(21),u=n(23),j=n(287),d=n(288),b=n(160),m=n(304),p=n(291),h=n(28),O=n.n(h),f=n(15),v=n(3),x=O()((function(e){return{formItems:{marginTop:e.spacing(2)}}}));var g=Object(f.g)((function(e){var t=x(),n=Object(a.useState)({room:""}),c=Object(u.a)(n,2),r=c[0],i=c[1];return Object(v.jsx)("div",{children:Object(v.jsx)(j.a,{children:Object(v.jsxs)(d.a,{children:[Object(v.jsx)(b.a,{gutterBottom:!0,variant:"h5",component:"h2",children:"Join a room"}),Object(v.jsxs)("form",{action:"",onSubmit:function(t){t.preventDefault(),e.history.push("/room/".concat(r.room))},children:[Object(v.jsx)(m.a,{name:"room",id:"outlined-basic",label:"Code",variant:"outlined",size:"small",fullWidth:!0,className:t.formItems,onChange:function(e){i(Object(o.a)(Object(o.a)({},r),{},Object(l.a)({},e.target.name,e.target.value)))}}),Object(v.jsx)(p.a,{variant:"contained",color:"primary",fullWidth:!0,className:t.formItems,type:"submit",children:"Join"})]})]})})})})),y=n(150),w=n.n(y)()("https://sync-yt-backend.herokuapp.com/");w.on("connect",(function(){console.log("connection established")}));var C=w,k=O()((function(e){return{formItems:{marginTop:e.spacing(2)}}}));var D=Object(f.g)((function(e){var t=k();return Object(v.jsx)("div",{children:Object(v.jsx)(j.a,{children:Object(v.jsxs)(d.a,{children:[Object(v.jsx)(b.a,{gutterBottom:!0,variant:"h5",component:"h2",children:"Create a room"}),Object(v.jsx)("form",{action:"",onSubmit:function(t){t.preventDefault(),C.emit("create-room",(function(t){e.history.push("/room/".concat(t))}))},children:Object(v.jsx)(p.a,{variant:"contained",color:"primary",fullWidth:!0,className:t.formItems,type:"submit",children:"Create"})})]})})})})),I=n(293),N=n(292),T=O()((function(e){return{root:{marginTop:e.spacing(8),marginBottom:e.spacing(4)}}}));function S(){Object(a.useEffect)((function(){null===localStorage.getItem("username")&&localStorage.setItem("username","anonymous".concat(Math.floor(1e4*Math.random())))}),[]);var e=T();return Object(v.jsxs)("div",{children:[Object(v.jsx)(b.a,{align:"center",variant:"h4",className:e.root,component:"h1",children:"Watch videos together"}),Object(v.jsx)(N.a,{maxWidth:"xs",children:Object(v.jsxs)(I.a,{container:!0,direction:"column",spacing:2,justify:"center",children:[Object(v.jsx)(I.a,{item:!0,xs:12,children:Object(v.jsx)(g,{})}),Object(v.jsx)(I.a,{item:!0,xs:12,children:Object(v.jsx)(D,{})})]})})]})}var W=n(296),B=n(295),E=n(308),R=n(151),V=n.n(R),L=n(297),M=n(152),P=n.n(M),J=n(294),A=n(13),G=Object(J.a)((function(e){return{title:Object(l.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),linkTitle:{color:"inherit",textDecoration:"none"},search:Object(l.a)({marginRight:e.spacing(2),position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(A.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(A.b)(e.palette.common.white,.25)},width:"100%"},e.breakpoints.up("sm"),{margin:"auto",width:350}),searchIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:Object(l.a)({padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:"20ch"})}})),X=n(70);function q(e){var t=G(),n=Object(a.useState)({url:""}),c=Object(u.a)(n,2),r=c[0],i=c[1];return Object(v.jsxs)("div",{children:[Object(v.jsx)(B.a,{style:{height:64}}),Object(v.jsx)(W.a,{position:"fixed",children:Object(v.jsxs)(B.a,{style:{height:64},children:[Object(v.jsx)(b.a,{className:t.title,variant:"h6",noWrap:!0,children:Object(v.jsx)(X.b,{to:"/",className:t.linkTitle,children:"Sync YT"})}),Object(v.jsxs)("div",{className:t.search,children:[Object(v.jsx)("div",{className:t.searchIcon,children:Object(v.jsx)(V.a,{})}),Object(v.jsx)(E.a,{name:"url",onChange:function(e){i(Object(o.a)(Object(o.a)({},r),{},Object(l.a)({},e.target.name,e.target.value)))},onKeyUp:function(t){if(13===t.keyCode){t.preventDefault();var n=function(e){var t=e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);return t?t[1]:null}(r.url);if(null===n)return console.log("invalid video url");C.emit("play",e.room,n)}},placeholder:"URL",classes:{root:t.inputRoot,input:t.inputInput},inputProps:{"aria-label":"search"}})]}),Object(v.jsx)(L.a,{color:"inherit",children:Object(v.jsx)(P.a,{})})]})})]})}var H=n(159),U=n(310),Y=n(309),z=n(154),F=n.n(z),K=n(155),Q=n.n(K);function Z(e){var t=(e=(e-e%1e3)/1e3)%60,n=(e=(e-t)/60)%60,a=(e-n)/60;return a>0?a+":"+n+":"+("0"+t).slice(-2):n>0?n+":"+("0"+t).slice(-2):("0"+t).slice(-2)}function $(e){var t=e.children,n=e.open,a=e.value;return Object(v.jsx)(Y.a,{open:n,enterTouchDelay:0,placement:"top",title:a,children:t})}var _=O()((function(e){return{controllsContainer:{height:85,padding:e.spacing(1)},playButton:{padding:e.spacing(1)},vidBar:{padding:e.spacing(1,0)}}}));function ee(e){var t=Object(a.useState)({time:0,timeDisplay:""}),n=Object(u.a)(t,2),c=n[0],r=n[1],i=_();Object(a.useEffect)((function(){var t=setInterval((function(){e.player.getCurrentTime().then((function(e){var t=1e3*e;r(Object(o.a)(Object(o.a)({},c),{},{time:t,timeDisplay:Z(t)}))}))}),100);return function(){clearInterval(t)}}),[]);return Object(v.jsx)("div",{children:Object(v.jsxs)(H.a,{variant:"outlined",square:!0,className:i.controllsContainer,children:[Object(v.jsx)(U.a,{className:i.vidBar,value:c.time,onChangeCommitted:function(t,n){C.emit("seekTo",e.room,n)},color:"secondary",ValueLabelComponent:$,min:0,max:e.end,valueLabelDisplay:"auto",valueLabelFormat:function(e){return Z(e)}}),Object(v.jsx)(L.a,{className:i.playButton,onClick:function(t){e.pause?C.emit("resume",e.room):C.emit("pause",e.room)},children:e.pause?Object(v.jsx)(F.a,{}):Object(v.jsx)(Q.a,{})}),Object(v.jsxs)(b.a,{variant:"body2",component:"span",children:[c.timeDisplay," / ",Z(e.end)]})]})})}var te=n(156),ne=n.n(te),ae=n(74),ce=n.n(ae),re=n(113);function ie(e,t){return new Promise((function(n){var a=setInterval(Object(re.a)(ce.a.mark((function c(){var r;return ce.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,e.getDuration();case 2:(r=c.sent)>0&&(t&&e.pauseVideo(),clearInterval(a),n(1e3*r));case 4:case"end":return c.stop()}}),c)}))),50)}))}function oe(e,t){var n=new Date;return new Promise((function(a){var c=setInterval(Object(re.a)(ce.a.mark((function r(){return ce.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getDuration();case 2:r.sent>0&&(e.seekTo(1*(.2+t+((new Date).getTime()-n.getTime()))/1e3),a(),clearInterval(c));case 4:case"end":return r.stop()}}),r)}))),50)}))}var se=O()((function(e){return{container:Object(l.a)({flexGrow:1},e.breakpoints.down("sm"),{}),playerWrapper:{position:"relative",paddingTop:"56.25%"},reactPlayer:{position:"absolute",top:0,left:0}}}));function le(e){var t=se(),n=Object(a.useState)(null),c=Object(u.a)(n,2),r=c[0],i=c[1],s=Object(a.useState)({start:0,end:0,pause:!0}),l=Object(u.a)(s,2),j=l[0],d=l[1];return Object(a.useEffect)((function(){var e=ne()("youtube-player",{height:"100%",width:"100%"});return i(e),C.on("play-recive",(function(e){i((function(t){return t.loadVideoById(e),ie(t,!1).then((function(e){return d((function(t){return Object(o.a)(Object(o.a)({},t),{},{end:e,start:0,pause:!1})}))})),t}))})),C.on("update",(function(e){i((function(t){return t.loadVideoById(e.videoId),oe(t,e.timeElapsed),ie(t,e.pause).then((function(t){d((function(n){return Object(o.a)(Object(o.a)({},n),{},{start:e.timeElapsed,end:t,pause:e.pause})}))})),t}))})),C.on("pause-recive",(function(){e.pauseVideo(),d((function(e){return Object(o.a)(Object(o.a)({},e),{},{pause:!0})}))})),C.on("resume-recive",(function(e){i((function(t){return t.playVideo(),oe(t,e),d((function(t){return Object(o.a)(Object(o.a)({},t),{},{start:e,pause:!1})})),t}))})),C.on("seekTo-recive",(function(e){i((function(t){return oe(t,e),d((function(t){return Object(o.a)(Object(o.a)({},t),{},{start:e})})),t}))})),function(){C.off("play-recive"),C.off("update"),C.off("pause-recive"),C.off("resume-recive"),C.off("seekTo-recive")}}),[]),Object(v.jsxs)("div",{className:t.container,children:[Object(v.jsx)("div",{className:t.playerWrapper,children:Object(v.jsx)("div",{id:"youtube-player",className:t.reactPlayer})}),r?Object(v.jsx)(ee,{pause:j.pause,room:e.room,player:r,end:j.end}):null]})}var ue=n(307),je=n(301),de=n(299),be=n(300),me=n(298);function pe(e){return Object(v.jsx)("div",{children:Object(v.jsxs)(ue.a,{open:e.open,onClose:e.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(v.jsx)(me.a,{id:"alert-dialog-title",children:"Error"}),Object(v.jsx)(de.a,{children:Object(v.jsx)(be.a,{id:"alert-dialog-description",children:"Room was not found, make sure it is the right code."})}),Object(v.jsx)(je.a,{children:Object(v.jsx)(p.a,{onClick:e.handleClose,color:"primary",children:"Close"})})]})})}var he=n(114),Oe=n(311),fe=O()((function(e){return{container:{wordWrap:"break-word",flexGrow:1,overflowY:"auto",padding:e.spacing(1,2)}}})),ve=c.a.memo((function(e){var t=fe(),n=Object(a.useState)([]),c=Object(u.a)(n,2),r=c[0],i=c[1],o=Object(a.useRef)(null);return Object(a.useEffect)((function(){o&&o.current.scrollIntoView({behavior:"smooth"})}),[r]),Object(a.useEffect)((function(){return C.on("message-recive",(function(e){if(console.log("recived"),r.length>49){var t=Object(he.a)(r);return t.push(e),t.shift(),i(t)}i((function(t){return[].concat(Object(he.a)(t),[e])}))})),C.on("join-chat",(function(e){i(e)})),function(){C.off("message-recive")}})),Object(v.jsxs)("div",{className:t.container,children:[r.map((function(e,t){return Object(v.jsxs)("div",{children:[Object(v.jsx)(b.a,{variant:"body1",component:"span",color:"primary",children:Object(v.jsxs)(Oe.a,{fontWeight:700,component:"span",children:[e.author,": "]})}),Object(v.jsx)(b.a,{variant:"body1",component:"span",children:e.message})]},t)})),Object(v.jsx)("div",{ref:o})]})})),xe=n(157),ge=n.n(xe),ye=n(302),we=n(305),Ce=Object(J.a)((function(e){return{chatControls:{padding:e.spacing(0,2),paddingBottom:e.spacing(2)},typeMessage:Object(l.a)({},"& fieldset",{borderRadius:0}),chat:Object(l.a)({height:"541px",display:"flex",flexDirection:"column",width:400,marginLeft:e.spacing(3)},e.breakpoints.down("sm"),{height:"calc(100% - 56.25vw - 85px)",width:"unset",flexGrow:1,margin:0})}}));function ke(e){var t=Ce(),n=Object(a.useState)({message:"",sendDisabled:!0}),c=Object(u.a)(n,2),r=c[0],i=c[1];return Object(v.jsxs)(H.a,{square:!0,className:t.chat,variant:"outlined",children:[Object(v.jsxs)(we.a,{smDown:!0,children:[Object(v.jsx)(b.a,{align:"center",variant:"h6",children:Object(v.jsx)(Oe.a,{lineHeight:2.5,children:"CHAT"})}),Object(v.jsx)(ye.a,{})]}),Object(v.jsx)(ve,{room:e.room}),Object(v.jsxs)("div",{className:t.chatControls,children:[Object(v.jsx)(m.a,{name:"message",value:r.message,variant:"outlined",onChange:function(t){var n=t.target.value;if("\n"!==n[0]&&" "!==n[0])return"\n"===n.substr(-1)?(t.preventDefault(),C.emit("message",e.room,r.message),void i(Object(o.a)(Object(o.a)({},r),{},{message:"",sendDisabled:!0}))):""===n?i(Object(o.a)(Object(o.a)({},r),{},{message:n,sendDisabled:!0})):void i(Object(o.a)(Object(o.a)({},r),{},{sendDisabled:!1,message:n}));t.preventDefault()},className:t.typeMessage,placeholder:"Send a message",multiline:!0,rowsMax:4,fullWidth:!0}),Object(v.jsx)(Oe.a,{textAlign:"right",marginTop:1,children:Object(v.jsx)(L.a,{color:"primary",onClick:function(t){i(Object(o.a)(Object(o.a)({},r),{},{message:"",sendDisabled:!0})),C.emit("message",e.room,r.message)},disabled:r.sendDisabled,children:Object(v.jsx)(ge.a,{})})})]})]})}var De=Object(J.a)((function(e){return{maxWithXl:{maxWidth:1700},container:Object(l.a)({paddingTop:e.spacing(2),height:"calc(100vh - 64px)"},e.breakpoints.down("sm"),{padding:0}),gridContainer:Object(l.a)({display:"flex",height:"100%"},e.breakpoints.down("sm"),{flexDirection:"column"})}}));function Ie(e){var t=De(),n=c.a.useState(!1),r=Object(u.a)(n,2),i=r[0],o=r[1];Object(a.useEffect)((function(){return C.emit("join-room",localStorage.getItem("username"),e.match.params.room,(function(e){0===e&&o(!0)})),function(){C.emit("leave",e.match.params.room)}}),[]);return Object(v.jsxs)("div",{children:[Object(v.jsx)(pe,{handleClose:function(){o(!1),e.history.push("/")},open:i}),Object(v.jsx)(q,{room:e.match.params.room}),Object(v.jsx)(N.a,{maxWidth:"lg",classes:{maxWidthXl:t.maxWithXl,root:t.container},children:Object(v.jsxs)("div",{className:t.gridContainer,children:[Object(v.jsx)(le,{room:e.match.params.room}),Object(v.jsx)(ke,{room:e.match.params.room})]})})]})}var Ne=function(){return Object(v.jsx)("div",{className:"App",children:Object(v.jsx)(s.a,{children:Object(v.jsx)(X.a,{children:Object(v.jsxs)(f.d,{children:[Object(v.jsx)(f.b,{exact:!0,component:S,path:"/"}),Object(v.jsx)(f.b,{path:"/room/:room",render:function(e){return Object(v.jsx)(Ie,Object(o.a)({},e))}}),Object(v.jsx)(f.a,{to:"/"})]})})})})};i.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(Ne,{})}),document.getElementById("root"))}},[[248,1,2]]]);
//# sourceMappingURL=main.57780be6.chunk.js.map